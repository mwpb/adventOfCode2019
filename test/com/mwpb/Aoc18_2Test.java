package com.mwpb;

import java.io.IOException;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import java.util.*;

public class Aoc18_2Test {
	
	String mazeString = "#################################################################################\n" +
            "#.#..a....#...#..........y..#.#.........#.I...#...#.....#.............#.......#.#\n" +
            "#.#.###.###.#.#P#########.#.#S#.#######.#.###.#.#.###.#.###.#########.#.#####.#.#\n" +
            "#.#...#.#...#...#.......#.#.#.#...#z....#...#.#.#.#...#...#.#...#.....#.#.......#\n" +
            "#.###.#.#.#######.#######.#.#.###.#.#####.#.#.#.#.#.#####.#.#.#.#.#####.#######.#\n" +
            "#q..#.#...#.#.....#.....#.#.#.....#.....#.#.#.#.#.#.....#..c#.#.#.......#.....#.#\n" +
            "#.###.#####.#.#.#.#.###.#.#.###########.#.#.#.#.#.#####.#####.#.#########.###.#.#\n" +
            "#.#...#.....#.#.#.#...#...#......b......#.#.#...#...#...#...#.#.....#.....#.#.#.#\n" +
            "#.#.###.#####.#.#####.#####.#######.#####.#.#######.#.#.#.#.#.#####.#.#####.#.###\n" +
            "#.#...#.......#.....#.#.....#.....#.#l..#.#...#.D.....#.#.#...#...#...#.....#...#\n" +
            "#.###.###.#######.#.#.#######.###.###.#.#.###.###.#####.#.#######.#####.###.###.#\n" +
            "#...#...#...#...#.#.#.......#...#.....#.#...#...#.#...#n#.#.......#....r..#.#...#\n" +
            "#.#.###.###.#.#.###.#######.###.#######.#######.#.#.#.#.#.#.#####.#.#######.#.###\n" +
            "#.#...#...#.#.#...........#...#.#.#...#.#.......#.#.#.#.#...#...#.#.....#...#...#\n" +
            "###.#####.###.###########.#.###.#.#.#.#.#.###.#####.#.#.#####.###.#######.#.###A#\n" +
            "#...#.....#...#...........#.#...#.#v#...#.#...#.....#.#...#...............#.#...#\n" +
            "#.###.#####.###.#####.#####.#.###.#.#####.#####.#####.#####.#################.###\n" +
            "#.....#.....#...#.G.#.#...#.......#.#...#...#.....#...#.....#.........#.....#.#.#\n" +
            "#.#####.#####.###.#.###.#.#######.#.###.#.#.#.#####.#.#.#####.#######.#.###.#.#.#\n" +
            "#.R...#.#.....#...#.#x..#...F.#.#.#...#.#.#...#...#.#.#.#...#.#.#...#.#...#...#.#\n" +
            "#####.#.#######.###.#.#######.#.#.###.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.###.#####.#\n" +
            "#.#...#.........#...#.#.....#.#...#...#.#.#...#.#...#.#...#.#.#...#.#.....#...#.#\n" +
            "#.#.#########.###.#.###.###.#.#####.###.#.#.#.#.###.#######.#######.#######.#.#.#\n" +
            "#...#.......#.#...#.....#.#.#.......#...#.#.#.#...#.#.....#.......#.#.....T.#...#\n" +
            "#.#####.###.#.#.#########.#.#########.###.#.#.###.#.#.###.#######.#.#.#.#######.#\n" +
            "#...M.#.#...#.#.....#.....#...#.........#.#.#.....#.#.#.#.....#.#.#...#.#.....#.#\n" +
            "#####.#.###.#.#####.###.#.###.#####.###.#.#.#########.#.###.#.#.#.#.###.#.###.#.#\n" +
            "#...#.#...#.#.....#...#.#...#.....#...#.#.#.......#...#.#...#...#.#.#...#...#.#.#\n" +
            "#.###.###.#.#########.#.#########.#####.#.#######.#.###.#.#######.#.#.#####.#.#.#\n" +
            "#...#.....#...........#.....#...#.......#.....#.#...#...#...#.....#.#.......#.#.#\n" +
            "#K#.###################.###.#.#.#######.#####.#.#######.###.#.#####.#########.#.#\n" +
            "#.#...........#.....#...#.#.#.#.......#.#.#...#...#.......#...#.............#.#.#\n" +
            "#.#.###.#######.#.###.###.#.#.#####.###.#.#.###.###.#.###.#####.#############.###\n" +
            "#.#.#...#.......#.....#...#...#...#...#.#...#.......#...#.....#.....#.......#...#\n" +
            "#.#.#.###.#############.#.#####.#.###.#.#.#########.###.#######.#####.#####.###.#\n" +
            "#.#.#...#.....#...H.....#.......#...#...#.#.......#...#.....#...#.....#...#...#.#\n" +
            "#.#.###.#####.#######.#########.###.#####.#.#####.###.#####.#.###.#####.#.###.#.#\n" +
            "#.#.#...#.....#.....#.......#...#...#...#...#.....#.......#.....#.....#.#...#.#.#\n" +
            "#.#.#####.#####.###.#########.###.#####.#####.#######################.#.#.###.#.#\n" +
            "#.#..........u..#.............#o.......0#1............................#.#....k..#\n" +
            "#################################################################################\n" +
            "#.#.......#.............#.......#......2#3..........#.....#....h......#.......#.#\n" +
            "#.#.#####.#.#######.#####.#####.#.#.###.#.###.#####.###O#.###.#######.#.#####.#.#\n" +
            "#.#.....#...#.....#.#.....#.....#.#.#.#.#...#.#.........#.....#...#...#...#.#...#\n" +
            "#.#####.#####.###.#.#.#####.#####.#.#.#.###.#.#################.#.#.###.#.#.###.#\n" +
            "#.E...#.#.#..w#...#.#.#.#.Z.#...#.#.#...#...#.#...#.......#.#.U.#...#...#.#...#.#\n" +
            "#.###.#.#.#.###.###.#.#.#.###.#.#.#.#####.###.#.#.#.#####.#.#.###########.#.#.#.#\n" +
            "#.#...#.#...#...#...#.#.#...#.#.#.#.....#...#...#...#...#.#.#.....#.....#.#.#.#.#\n" +
            "#.#.###.#.###.#.#.###.#.###.#.#.#####.#.###.#########.#.#.#.#####.#.###.#.#.#.#.#\n" +
            "#.#...#.#...#.#.#...#.#...#s..#.....#.#.#.#.#.........#.#.#.#...#...#.#...#.#.#.#\n" +
            "#####.#.###.#.#####.#.#.#.#########.#.#.#.#.#.#####.#####.#.#.#.#####.#####.#.#.#\n" +
            "#.....#.#...#.....#...#.#.......#...#.#.#.#.#.#.....#.....#...#.......#.....#...#\n" +
            "#.#####.#########.#####.#######.#.#####.#.#.###.###.#.#####.###.#######.#########\n" +
            "#.#.....#...#...#.....#.#...#...#.#.....#.#.#...#...#.#.#...#.#.....#...#...#..m#\n" +
            "#.#.#####.#.#.#.#.###.#.#.#.#####.#.###.#.#.#.###.###.#.#.###.#####.#.###.#.###.#\n" +
            "#.#.#.....#.#.#...#.#.#...#...#...#...#.#.#...#.....#.#...#.......#...#..e#...#.#\n" +
            "#.#.#####.#.#.#####.#.###.###.#.###.#.###.###.#######.#.#######.#.#####.#####.#.#\n" +
            "#.#...#...#...#.....#...#.#...#.L.#.#...#.#...#...#...#.....#...#...#...#...#...#\n" +
            "#.###.#.#######.###.###.###.#.###.#.###.#.#.###.#.#.#######.#.#####J#.###.#.###.#\n" +
            "#...#...#...#...#.#.......#.#.#...#...#.#.....#.#...#.#.......#.......#...#.#...#\n" +
            "#.#.#######.#.###.#######.#.###.###.###.#.#####.#####.#.###############.#.###.###\n" +
            "#.#.#.......#.#.....#...#...#...#...#...#...#...#.......#...#.#.....#.#.#.....#.#\n" +
            "#.###.#.#####.#.###.###.#####.###.###.#.#####.###.#########.#.#.###.#.#.#######.#\n" +
            "#...#.#.......#...#...#.#...#.#...#.#.#.#.....#.#...#.....#.#...#.#.#.#.....#...#\n" +
            "#.#.#.###########.#.#.#X#.#.#.###.#.#.###.#####.###.#.#.#.#.#####.#.#.#####.###Q#\n" +
            "#j#.#...#.........#.#.#...#.#.V.#...#...#.#.......#.#.#.#...#.....#.#.....#.#...#\n" +
            "###.###.#.#########.#######.#.#.#######.#.###.#.###.#.#.###.#.#.###.#.#.###.#.#.#\n" +
            "#...#...#...#.....#d....#...#.#.#.......#...#.#.#...#.#...#...#.#...#.#.....#.#.#\n" +
            "#.#.#.#####.###.#.###.#.#.#####.#.#####.###.###.#.#######.#####.#.###W#######.#.#\n" +
            "#.#.#.#.......#.#...#.#.#.#..f..#...#.#.#...#...#...#...#...#...#.#.#.....#...#.#\n" +
            "#.#.#.#######.#.#.#.#.###.###.###.#.#.#.#.###.#####.#.#.###.#.###.#.#####.#.###.#\n" +
            "#.#.#.....C.#.#.#.#.#...#.....#...#.#.#.#.#...........#...#.#.#...#.....#...#.#.#\n" +
            "#.#########.#.###.#.###.#######.###.#.#.#.#####.#########.#.###.###.#.#######.#.#\n" +
            "#...#.....#.#.....#...#.....#.....#.#...#.....#.#.......#...#...#...#.........#.#\n" +
            "#.#.#.###.#.###########.###.#######.###.#.###.###.#####.#####.###.#########.#.#.#\n" +
            "#.#.....#.#.......#...#...#t#.....#...#.#...#.....#...#.....#...#.Y.#.#.....#.#.#\n" +
            "#.#######.#######.#.#.###.#.#.###.###.#.###.#######.#######.###.###.#.#.#######.#\n" +
            "#..g#.#...#.......#.#.#...#...#...#...#.#.#.#.....#.......#...#.#.#.#.#....p..#.#\n" +
            "###.#.#N###.#######.#.#.#######.###.###.#.#.#.###.#######.###.#.#.#.#.#######.#.#\n" +
            "#.....#.............#...#........i..#...#.....#.............#...#.........B.#...#\n" +
            "#################################################################################";
	
	@Test
	void testExamples() {
		
		Aoc18_2 aoc18test3 = new Aoc18_2(
				"#############\n" + 
				"#g#f.D#..h#l#\n" + 
				"#F###e#E###.#\n" + 
				"#dCba0#1BcIJ#\n" + 
				"#############\n" + 
				"#nK.L2#3G...#\n" + 
				"#M###N#H###.#\n" + 
				"#o#m..#i#jk.#\n" + 
				"#############");
        aoc18test3.getAdjList();
        int minSteps3 = aoc18test3.mainDistance(new RobotsState(
        		new HashSet<>(Set.of('0','1','2','3')),
        		new HashSet<>(),
        		aoc18test3.keysLeft.size()));
        Assertions.assertEquals(minSteps3, 72);
		
		Aoc18_2 aoc18test2 = new Aoc18_2(
				"#############\n" + 
				"#DcBa.#.GhKl#\n" + 
				"#.###0#1#I###\n" + 
				"#e#d#####j#k#\n" + 
				"###C#2#3###J#\n" + 
				"#fEbA.#.FgHi#\n" + 
				"#############");
        aoc18test2.getAdjList();
        int minSteps2 = aoc18test2.mainDistance(new RobotsState(
        		new HashSet<>(Set.of('0','1','2','3')),
        		new HashSet<>(),
        		aoc18test2.keysLeft.size()));
        Assertions.assertEquals(minSteps2, 32);
		
		Aoc18_2 aoc18test = new Aoc18_2("###############\n" + 
				"#d.ABC.#.....a#\n" + 
				"######0#1######\n" + 
				"###############\n" + 
				"######2#3######\n" + 
				"#b.....#.....c#\n" + 
				"###############");
        aoc18test.getAdjList();
        int minSteps = aoc18test.mainDistance(new RobotsState(
        		new HashSet<>(Set.of('0','1','2','3')),
        		new HashSet<>(),
        		aoc18test.keysLeft.size()));
        Assertions.assertEquals(minSteps, 24);
	}
	
	@Test
	void testMain() {
		Aoc18_2 aoc18 = new Aoc18_2(this.mazeString);
        aoc18.getAdjList();
        System.out.println(aoc18.adjList);
        System.out.println(aoc18.keysLeft);
        int minSteps = aoc18.mainDistance(new RobotsState(
        		new HashSet<>(Set.of('0','1','2','3')),
        		new HashSet<>(),
        		aoc18.keysLeft.size()));// ans: 1828 after 204.94 seconds
        Assertions.assertEquals(minSteps, 4118);
	}
}
